<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>AZAAN Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>
</head>
<body class="bg-gray-100 p-6 font-sans">

  <h1 class="text-2xl font-bold text-green-700 mb-6 text-center">AZAAN SUNNATI LEBAS Admin Panel</h1>

  <form id="productForm" class="bg-white p-6 rounded shadow-md max-w-xl mx-auto space-y-4">
    <input type="text" id="category" placeholder="ক্যাটাগরি (যেমনঃ পাঞ্জাবি)" class="w-full border p-2 rounded" required />
    <input type="text" id="subcategory" placeholder="সাব-ক্যাটাগরি (যেমনঃ লিনেন)" class="w-full border p-2 rounded" required />
    <input type="text" id="name" placeholder="প্রোডাক্ট নাম" class="w-full border p-2 rounded" required />
    <input type="text" id="price" placeholder="মূল্য (যেমনঃ ৭৫০৳)" class="w-full border p-2 rounded" required />
    <textarea id="description" placeholder="বর্ণনা" class="w-full border p-2 rounded"></textarea>
    <input type="file" id="image" accept="image/*" class="w-full border p-2 rounded bg-white" required />
    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded w-full">প্রোডাক্ট যুক্ত করুন</button>
  </form>

  <div id="message" class="text-center text-green-600 mt-4 font-semibold"></div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyC9oDupW2atBfT_Y2TylOjm3dKhG1PpkJY",
      authDomain: "azaansunatilebas.firebaseapp.com",
      projectId: "azaansunatilebas",
      storageBucket: "azaansunatilebas.appspot.com",
      messagingSenderId: "854978097747",
      appId: "1:854978097747:web:3ae3d004d5df2568858ca6",
      measurementId: "G-WF027GFB8B"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    const form = document.getElementById("productForm");
    const messageDiv = document.getElementById("message");

    form.onsubmit = async (e) => {
      e.preventDefault();

      const category = form.category.value.trim();
      const subcategory = form.subcategory.value.trim();
      const name = form.name.value.trim();
      const price = form.price.value.trim();
      const description = form.description.value.trim();
      const file = form.image.files[0];

      if (!file) {
        alert("ছবি দিন");
        return;
      }

      // Storage path: category/subcategory/productname_timestamp.jpg
      const imageRef = storage.ref(`${category}/${subcategory}/${Date.now()}_${file.name}`);
      await imageRef.put(file);
      const imageUrl = await imageRef.getDownloadURL();

      const product = {
        name,
        price,
        description,
        img: imageUrl,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      };

      // Firestore path: categories > category > subcategories > subcategory > products
      await db
        .collection("categories")
        .doc(category)
        .collection("subcategories")
        .doc(subcategory)
        .collection("products")
        .add(product);

      messageDiv.innerText = "✅ সফলভাবে যুক্ত হয়েছে!";
      form.reset();
    };
  </script>
</body>
</html>
